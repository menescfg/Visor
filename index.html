<script>
  const map = L.map('map').setView([13.70, -89.19], 12);

  const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19, attribution: '&copy; OpenStreetMap'
  }).addTo(map);

  const esri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    maxZoom: 19, attribution: 'Tiles © Esri'
  });

  // Contenedores
  const overlays = {};

  // PERFORADOS (puntos)
  fetch('data/perforados.geojson').then(r => r.json()).then(geo => {
    const lyr = L.geoJSON(geo, {
      pointToLayer: (f, latlng) => L.circleMarker(latlng, {radius: 6, fillOpacity: 0.9, color:'#333', weight:1}),
      onEachFeature: (f, layer) => {
        const p = f.properties || {};
        layer.bindPopup(`<b>${p.nombre || 'Perforación'}</b><br>Fuente: ${p.fuente || '-'}${p.anio ? ' · ' + p.anio : ''}`);
      }
    }).addTo(map);
    overlays["Perforados"] = lyr;
    L.control.layers({"OpenStreetMap":osm, "Esri Satélite":esri}, overlays, {collapsed:false}).addTo(map);
  });

  // EXCAVADOS (polígonos o líneas)
  fetch('data/excavados.geojson').then(r => r.json()).then(geo => {
    const lyr = L.geoJSON(geo, {
      style: {color:'#1f78b4', weight:2, fillOpacity:0.1}
    }).addTo(map);
    overlays["Excavados"] = lyr;
  });

  L.control.scale().addTo(map);
</script>
